<%= form_tag(lesson_path(id: @lesson_obj.id, form_step:4), method: :patch, multipart: true, class: "Form") do %>

  <%= field_set_tag 'Who is this for?', class: 'Form__fieldset' do %>

    <!-- lesson.grade_range -->
    <div class="FormField FormField--required FormField--with-border">

      <div class="FormField__info">
        <label class="FormField__label" for="lesson_name">Grade range</label>
        <div class="FormField__hint">Specify one or more</div>
      </div>

      <%= render partial: 'lessons/form/grade_range' %>

    </div>

    <!-- lesson.subjects -->
    <div class="FormField FormField--required FormField--with-border">

      <div class="FormField__info">
        <label class="FormField__label" for="lesson_name">Subjects</label>
        <div class="FormField__hint">Specify one or more</div>
      </div>

      <div class="FormField__input">
        <div class="CheckboxButtons">
          <% @subjects.each do |s| %>
          <div class="CheckboxButton">
            <input type="checkbox" class="CheckboxButton__input" name="lesson[subjects][]" value="<%= s.id %>" <%= @lesson_obj.subjects.include?(s) ? 'checked' : nil %> id="lesson__subjects__<%= s.id %>" />
            <label class="CheckboxButton__label Button Button--outline Button--small Button--extra-padding Button--icon Button--icon--<%= s.name %>" for="lesson__subjects__<%= s.id %>"><%= s.name.titleize %></label>
          </div>
          <% end %>
        </div>
      </div>

    </div>

    <!-- lesson.difficulty -->
    <div class="FormField FormField--required FormField--with-border">

      <div class="FormField__info">
        <label class="FormField__label" for="lesson_name">Difficulty level</label>
        <div class="FormField__hint">How hard is this lesson?</div>
      </div>

      <%= render partial: "lessons/form/difficulty" %>

    </div>

    <!-- lesson.context -->
    <div class="FormField FormField--required FormField--with-border">

      <div class="FormField__info">
        <label class="FormField__label" for="lesson_name">Context</label>
        <div class="FormField__hint">What kind of project is this?</div>
      </div>

      <%= render partial: "lessons/form/contexts" %>

    </div>

    <!-- lesson.collection -->
    <div class="FormField FormField--required FormField--with-border">

      <div class="FormField__info">
        <label class="FormField__label" for="lesson_name">Collection</label>
        <div class="FormField__hint">Does this belong to a collection?</div>
      </div>

      <div class="FormField__input">
        <%= select(:lesson, :collection_tag, options_for_select(@collections)) %>
      </div>

    </div>

    <!-- lesson.tags -->
    <div class="FormField FormField--required">

      <div class="FormField__info">
        <label class="FormField__label" for="lesson_name">Tags</label>
        <div class="FormField__hint">Enter, comma, separated, tags</div>
      </div>

      <div class="FormField__input">
        <%= text_field(:lesson, :tags, multiple: true, class: "Input--choices") %>
      </div>

    </div>

  <% end %>

  <div class="Form__footer">

    <div class="Form__footer__content">

      <div class="Form__footer__actions">
        <a href="#" class="Form__footer__action Button Button--primary Button--small Button--icon Button--icon--left Button--arrow--left">Back to standards</a>
        <button class="Form__footer__action Button Button--primary Button--small Button--icon Button--icon--right Button--arrow--right">Add some instructions</button>
      </div>

    </div>

  </div>


<% end %>
